{% extends "base.html" %}
{% load static %}
{% block title %}Reviews Management - Admin{% endblock %}

{% block content %}
<div style="padding:20px;">
  <!-- Header -->
  <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:32px;">
    <div>
      <h1 style="margin:0 0 8px; font-size:32px;">Reviews Management</h1>
      <p style="color:var(--muted);">Total: {{ reviews|length }} pending reviews</p>
    </div>
    <a href="{% url 'admin_panel:dashboard' %}" class="btn secondary" style="padding:10px 20px;">‚Üê Back</a>
  </div>

  <!-- Tabs -->
  <div style="margin-bottom:32px; display:flex; gap:12px; border-bottom:1px solid var(--line); padding-bottom:16px;">
    <a href="{% url 'admin_panel:reviews_list' %}" class="btn secondary" style="padding:10px 16px; background:rgba(59,130,246,0.2); border:none; text-decoration:none;">
      üìã Pending
    </a>
    <a href="{% url 'admin_panel:reviews_approved' %}" class="btn secondary" style="padding:10px 16px; border:none; text-decoration:none;">
      ‚úì Approved
    </a>
    <a href="{% url 'admin_panel:reviews_flagged' %}" class="btn secondary" style="padding:10px 16px; border:none; text-decoration:none;">
      ‚ö†Ô∏è Flagged
    </a>
  </div>

  <!-- Reviews Grid -->
  <div style="display:grid; gap:16px;">
    {% for review in reviews %}
      <div style="padding:16px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
        <!-- Review Header -->
        <div style="display:flex; justify-content:space-between; align-items:start; margin-bottom:12px;">
          <div>
            <div style="font-weight:500;">{{ review.user.username }} <span style="color:#fbbf24;">‚òÖ {{ review.rating }}/5</span></div>
            <div style="color:var(--muted); font-size:12px;">on {{ review.app.title }}</div>
            <div style="color:var(--muted); font-size:12px;">{{ review.created_at|date:"M d, Y H:i" }}</div>
          </div>
        </div>

        <!-- Review Text -->
        <p style="margin:0 0 12px; color:var(--text); line-height:1.5;">{{ review.comment }}</p>

        <!-- Actions -->
        <div style="display:flex; gap:8px;">
          <form method="post" action="{% url 'admin_panel:reviews_approve' pk=review.pk %}" style="display:inline;">
            {% csrf_token %}
            <button type="submit" class="btn secondary" style="padding:8px 16px; font-size:12px;" onclick="return confirm('Approve this review?');">Approve</button>
          </form>
          <form method="post" action="{% url 'admin_panel:reviews_delete' pk=review.pk %}" style="display:inline;">
            {% csrf_token %}
            <button type="submit" class="btn secondary" style="padding:8px 16px; font-size:12px; background:rgba(251,113,133,0.15); border:1px solid rgba(251,113,133,0.3); color:rgba(251,113,133,0.9);" onclick="return confirm('Delete this review?');">Delete</button>
          </form>
          <form method="post" action="{% url 'admin_panel:reviews_flag' pk=review.pk %}" style="display:inline;">
            {% csrf_token %}
            <button type="submit" class="btn secondary" style="padding:8px 16px; font-size:12px; background:rgba(251,191,36,0.15); border:1px solid rgba(251,191,36,0.3); color:rgba(251,191,36,0.9);">Flag</button>
          </form>
        </div>
      </div>
    {% empty %}
      <div style="padding:32px; text-align:center; color:var(--muted); background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
        No pending reviews to moderate
      </div>
    {% endfor %}
  </div>
</div>
{% endblock %}
