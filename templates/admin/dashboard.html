{% extends "base.html" %}
{% load static %}
{% block title %}Admin Dashboard - JN App Store{% endblock %}
{% block extra_css %}<link rel="stylesheet" href="{% static 'css/review_form.css' %}">{% endblock %}

{% block content %}
<div style="padding:20px;">
  <!-- Header -->
  <div style="margin-bottom:32px;">
    <h1 style="margin:0 0 8px; font-size:32px;">Admin Dashboard</h1>
    <p style="color:var(--muted);">Manage apps, users, categories, and reviews</p>
  </div>

  <!-- Main Stats Grid -->
  <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(220px, 1fr)); gap:16px; margin-bottom:32px;">
    <!-- Total Apps -->
    <div style="padding:20px; background:rgba(59,130,246,0.1); border:1px solid rgba(59,130,246,0.2); border-radius:12px;">
      <div style="font-size:28px; font-weight:bold; color:#3b82f6; margin-bottom:4px;">{{ total_apps }}</div>
      <div style="color:var(--muted); font-size:14px;">Total Apps</div>
      <div style="color:var(--muted); font-size:12px; margin-top:8px;">
        <span style="color:#22c55e;">{{ published_apps }}</span> published,
        <span style="color:#f59e0b;">{{ draft_apps }}</span> draft
      </div>
    </div>

    <!-- Total Users -->
    <div style="padding:20px; background:rgba(139,92,246,0.1); border:1px solid rgba(139,92,246,0.2); border-radius:12px;">
      <div style="font-size:28px; font-weight:bold; color:#8b5cf6; margin-bottom:4px;">{{ total_users }}</div>
      <div style="color:var(--muted); font-size:14px;">Total Users</div>
      <div style="color:var(--muted); font-size:12px; margin-top:8px;">
        <span style="color:#22c55e;">{{ active_users }}</span> active today
      </div>
    </div>

    <!-- Total Downloads -->
    <div style="padding:20px; background:rgba(236,72,153,0.1); border:1px solid rgba(236,72,153,0.2); border-radius:12px;">
      <div style="font-size:28px; font-weight:bold; color:#ec4899; margin-bottom:4px;">{{ total_downloads }}</div>
      <div style="color:var(--muted); font-size:14px;">Total Downloads</div>
      <div style="color:var(--muted); font-size:12px; margin-top:8px;">This month</div>
    </div>

    <!-- Total Reviews -->
    <div style="padding:20px; background:rgba(251,191,36,0.1); border:1px solid rgba(251,191,36,0.2); border-radius:12px;">
      <div style="font-size:28px; font-weight:bold; color:#fbbf24; margin-bottom:4px;">{{ total_reviews }}</div>
      <div style="color:var(--muted); font-size:14px;">Total Reviews</div>
      <div style="color:var(--muted); font-size:12px; margin-top:8px;">Average rating: {{ avg_rating|floatformat:1 }}/5</div>
    </div>
  </div>

  <!-- Management Sections Grid -->
  <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(280px, 1fr)); gap:20px; margin-bottom:32px;">
    <!-- Apps Management -->
    <div style="padding:20px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
      <h3 style="margin:0 0 16px; font-size:18px;">ğŸ“± Apps Management</h3>
      <p style="color:var(--muted); font-size:13px; margin:0 0 16px;">Manage application submissions and versions</p>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="{% url 'admin_panel:apps_list' %}" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">View All Apps</a>
        <a href="{% url 'admin_panel:apps_pending' %}" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Pending Approval ({{ pending_apps }})</a>
      </div>
    </div>

    <!-- Users Management -->
    <div style="padding:20px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
      <h3 style="margin:0 0 16px; font-size:18px;">ğŸ‘¥ Users Management</h3>
      <p style="color:var(--muted); font-size:13px; margin:0 0 16px;">Manage user accounts and permissions</p>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="{% url 'admin_panel:users_list' %}" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">View All Users</a>
        <a href="{% url 'admin_panel:users_create' %}" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">+ Create User</a>
      </div>
    </div>

    <!-- Categories Management -->
    <div style="padding:20px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
      <h3 style="margin:0 0 16px; font-size:18px;">ğŸ·ï¸ Categories</h3>
      <p style="color:var(--muted); font-size:13px; margin:0 0 16px;">Manage app categories and taxonomy</p>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="{% url 'admin_panel:categories_list' %}" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">View All Categories</a>
        <a href="{% url 'admin_panel:categories_create' %}" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">+ Create Category</a>
      </div>
    </div>

    <!-- Reviews Management -->
    <div style="padding:20px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
      <h3 style="margin:0 0 16px; font-size:18px;">â­ Reviews & Ratings</h3>
      <p style="color:var(--muted); font-size:13px; margin:0 0 16px;">Manage user reviews and ratings</p>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="{% url 'admin_panel:reviews_list' %}" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">View All Reviews</a>
        <a href="{% url 'admin_panel:reviews_flagged' %}" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Flagged Reviews ({{ flagged_reviews }})</a>
      </div>
    </div>

    <!-- Pending Deletions -->
    <div style="padding:20px; background:rgba(251,113,133,0.04); border:1px solid rgba(251,113,133,0.2); border-radius:12px;">
      <h3 style="margin:0 0 16px; font-size:18px;">ğŸ—‘ï¸ Pending Deletions</h3>
      <p style="color:var(--muted); font-size:13px; margin:0 0 16px;">Approve or cancel app deletions</p>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="{% url 'admin_panel:pending_deletions' %}" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px; background:rgba(251,113,133,0.15); border:1px solid rgba(251,113,133,0.3); color:rgba(251,113,133,0.9);">
          Review Deletions ({{ pending_deletions }})
        </a>
      </div>
    </div>

    <!-- Analytics -->
    <div style="padding:20px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
      <h3 style="margin:0 0 16px; font-size:18px;">ğŸ“Š Analytics</h3>
      <p style="color:var(--muted); font-size:13px; margin:0 0 16px;">View detailed analytics and reports</p>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="{% url 'admin_panel:analytics_overview' %}" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Analytics Overview</a>
        <a href="{% url 'admin_panel:analytics_reports' %}" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Reports</a>
      </div>
    </div>

    <!-- Settings -->
    <div style="padding:20px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
      <h3 style="margin:0 0 16px; font-size:18px;">âš™ï¸ System Settings</h3>
      <p style="color:var(--muted); font-size:13px; margin:0 0 16px;">Configure app store and security</p>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="{% url 'admin_panel:settings' %}" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">General Settings</a>
        <a href="{% url 'admin_panel:moderation' %}" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Moderation Rules</a>
      </div>
    </div>

    <!-- Reports & Logs -->
    <div style="padding:20px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
      <h3 style="margin:0 0 16px; font-size:18px;">ğŸ“‹ Logs & Reports</h3>
      <p style="color:var(--muted); font-size:13px; margin:0 0 16px;">View system logs and generated reports</p>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="{% url 'admin_panel:analytics_reports' %}" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">View Reports</a>
        <button class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;" disabled>System Logs (Coming Soon)</button>
      </div>
    </div>

    <!-- Support & Help -->
    <div style="padding:20px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
      <h3 style="margin:0 0 16px; font-size:18px;">ğŸ’¬ Support & Help</h3>
      <p style="color:var(--muted); font-size:13px; margin:0 0 16px;">Get help and documentation</p>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Admin Guide</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">FAQ</a>
      </div>
    </div>

    <!-- Developer Management -->
    <div style="padding:20px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
      <h3 style="margin:0 0 16px; font-size:18px;">ğŸ‘¨â€ğŸ’» Developer Management</h3>
      <p style="color:var(--muted); font-size:13px; margin:0 0 16px;">Manage developer accounts and permissions</p>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">All Developers</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Top Developers (Coming Soon)</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Suspended Accounts</a>
      </div>
    </div>

    <!-- Payment & Billing -->
    <div style="padding:20px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
      <h3 style="margin:0 0 16px; font-size:18px;">ğŸ’³ Payment & Billing</h3>
      <p style="color:var(--muted); font-size:13px; margin:0 0 16px;">Manage payments and revenue</p>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Revenue Reports (Coming Soon)</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Payouts</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Transactions</a>
      </div>
    </div>

    <!-- Content Moderation -->
    <div style="padding:20px; background:rgba(255,165,0,0.04); border:1px solid rgba(255,165,0,0.2); border-radius:12px;">
      <h3 style="margin:0 0 16px; font-size:18px;">ğŸš¨ Content Moderation</h3>
      <p style="color:var(--muted); font-size:13px; margin:0 0 16px;">Review reported content and manage violations</p>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Reported Apps (Coming Soon)</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Reported Reviews</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Blocked Content</a>
      </div>
    </div>

    <!-- Security & Compliance -->
    <div style="padding:20px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
      <h3 style="margin:0 0 16px; font-size:18px;">ğŸ”’ Security & Compliance</h3>
      <p style="color:var(--muted); font-size:13px; margin:0 0 16px;">Security settings and compliance tools</p>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Security Logs (Coming Soon)</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">GDPR Compliance</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">IP Blocking</a>
      </div>
    </div>

    <!-- Featured Apps Management -->
    <div style="padding:20px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
      <h3 style="margin:0 0 16px; font-size:18px;">â­ Featured Apps</h3>
      <p style="color:var(--muted); font-size:13px; margin:0 0 16px;">Manage featured & promoted apps</p>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Feature Manager (Coming Soon)</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Promotional Slots</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Homepage Banner</a>
      </div>
    </div>

    <!-- Email & Notifications -->
    <div style="padding:20px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
      <h3 style="margin:0 0 16px; font-size:18px;">ğŸ“§ Email & Notifications</h3>
      <p style="color:var(--muted); font-size:13px; margin:0 0 16px;">Manage email campaigns and alerts</p>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Email Campaigns (Coming Soon)</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Notification Templates</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Subscriber List</a>
      </div>
    </div>

    <!-- API Management -->
    <div style="padding:20px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
      <h3 style="margin:0 0 16px; font-size:18px;">ğŸ”Œ API Management</h3>
      <p style="color:var(--muted); font-size:13px; margin:0 0 16px;">Manage API keys and integrations</p>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">API Keys (Coming Soon)</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Webhooks</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">API Documentation</a>
      </div>
    </div>

    <!-- User Engagement -->
    <div style="padding:20px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
      <h3 style="margin:0 0 16px; font-size:18px;">ğŸ‘¥ User Engagement</h3>
      <p style="color:var(--muted); font-size:13px; margin:0 0 16px;">Track and engage users</p>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">User Segments (Coming Soon)</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Activity Timeline</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">User Feedback</a>
      </div>
    </div>

    <!-- Content Library -->
    <div style="padding:20px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
      <h3 style="margin:0 0 16px; font-size:18px;">ğŸ“š Content Library</h3>
      <p style="color:var(--muted); font-size:13px; margin:0 0 16px;">Manage pages and documentation</p>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Pages (Coming Soon)</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Blog Posts</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Help Articles</a>
      </div>
    </div>

    <!-- Backup & Maintenance -->
    <div style="padding:20px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
      <h3 style="margin:0 0 16px; font-size:18px;">ğŸ”§ Backup & Maintenance</h3>
      <p style="color:var(--muted); font-size:13px; margin:0 0 16px;">System maintenance and backups</p>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Create Backup (Coming Soon)</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">System Health</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Database Cleanup</a>
      </div>
    </div>

    <!-- Advanced Analytics -->
    <div style="padding:20px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
      <h3 style="margin:0 0 16px; font-size:18px;">ğŸ“ˆ Advanced Analytics</h3>
      <p style="color:var(--muted); font-size:13px; margin:0 0 16px;">Deep insights and custom reports</p>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Custom Reports (Coming Soon)</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">User Demographics</a>
        <a href="#" class="btn secondary" style="padding:10px; text-align:center; text-decoration:none; font-size:13px;">Trend Analysis</a>
      </div>
    </div>
  </div>

  <!-- Recent Activity -->
  <div style="padding:20px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px; margin-bottom:32px;">
    <h2 style="margin:0 0 16px; font-size:20px;">Recent Activity</h2>
    
    {% if recent_apps %}
      <div style="margin-bottom:16px;">
        <h4 style="margin:0 0 12px; color:var(--muted); font-size:13px; text-transform:uppercase;">Recently Published Apps</h4>
        <div style="display:grid; gap:8px;">
          {% for app in recent_apps %}
            <div style="padding:12px; background:rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.05); border-radius:8px; display:flex; justify-content:space-between; align-items:center;">
              <div>
                <div style="font-weight:500;">{{ app.title }} <span style="color:var(--muted); font-size:12px;">v{{ app.version }}</span></div>
                <div style="color:var(--muted); font-size:12px;">by {{ app.developer.username }}</div>
              </div>
              <a href="{% url 'admin_panel:apps_edit' slug=app.slug %}" class="btn secondary" style="padding:6px 12px; font-size:12px;">Edit</a>
            </div>
          {% empty %}
            <p style="color:var(--muted); font-size:13px;">No recent apps</p>
          {% endfor %}
        </div>
      </div>
    {% endif %}

    {% if recent_reviews %}
      <div>
        <h4 style="margin:0 0 12px; color:var(--muted); font-size:13px; text-transform:uppercase;">Recent Reviews</h4>
        <div style="display:grid; gap:8px;">
          {% for review in recent_reviews %}
            <div style="padding:12px; background:rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.05); border-radius:8px;">
              <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                <div style="font-weight:500;">{{ review.reviewer.username }} <span style="color:#fbbf24;">â˜… {{ review.rating }}</span></div>
                <span style="color:var(--muted); font-size:12px;">{{ review.created_at|date:"M d" }}</span>
              </div>
              <p style="margin:0; color:var(--muted); font-size:13px;">{{ review.text|truncatewords:15 }}</p>
            </div>
          {% empty %}
            <p style="color:var(--muted); font-size:13px;">No recent reviews</p>
          {% endfor %}
        </div>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
