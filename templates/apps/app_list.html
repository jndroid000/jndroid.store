{% extends "base.html" %}
{% load static %}
{% block title %}Browse Apps - jndroid store{% endblock %}
{% block extra_css %}<link rel="stylesheet" href="{% static 'css/app_list.css' %}">{% endblock %}

{% block content %}
<div class="pageHeader">
  <h1>Browse Apps</h1>
  <p>সব অ্যাপ এক জায়গায় — খুঁজুন, ডাউনলোড করুন, ব্যবহার করুন।</p>
</div>

<!-- SEARCH & FILTER -->
<div class="filterBar">
  <form method="get" class="search" style="flex:1; min-width:240px;">
    <input name="q" value="{{ q }}" type="text" placeholder="Search apps..." />
  </form>
  <select name="cat" style="padding:10px; border-radius:14px; border:1px solid var(--line); background:var(--card); color:var(--text);">
    <option value="">All Categories</option>
    {% for c in categories %}
      <option value="{{ c.slug }}" {% if cat == c.slug %}selected{% endif %}>{{ c.name }}</option>
    {% endfor %}
  </select>
  <button class="btn primary" style="margin-left:auto;">Search</button>
</div>

<!-- APPS GRID -->
{% if apps %}
  <div class="sectionTitle">
    <div>
      <h2>Trending Today</h2>
      <p>Latest and popular apps</p>
    </div>
  </div>
  
  <div class="appGrid">
    {% for a in apps %}
      <article class="app">
        <div class="appIcon">{{ a.title|first|upper }}</div>
        <div class="appMeta">
          <b><a href="{% url 'apps:detail' a.slug %}">{{ a.title }}</a></b>
          <small>{{ a.category.name }} • {{ a.platform|title }} • v{{ a.version|default:"-" }}</small>
          <div class="row">
            <span class="tag">⭐ {{ a.avg_rating|default_if_none:"0"|floatformat:1 }}</span>
            <span class="tag">⬇ {{ a.downloads }}</span>
            {% if a.is_published %}
              <span class="tag">Verified</span>
            {% endif %}
          </div>
          <div class="dl">
            <span>Size: {{ a.size_mb|default:"0" }}MB</span>
            <div style="flex:1;"></div>
            <a class="btn primary" href="{% url 'apps:download' a.slug %}" style="padding:8px 12px; font-size:12px;">Download</a>
          </div>
        </div>
      </article>
    {% endfor %}
  </div>
{% else %}
  <div class="noReviews">
    <p>No apps found. Try adjusting your search or filter.</p>
  </div>
{% endif %}
{% endblock %}
