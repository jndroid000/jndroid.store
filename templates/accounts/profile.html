{% extends "base.html" %}
{% load static %}
{% block title %}Developer Profile - JN App Store{% endblock %}
{% block extra_css %}<link rel="stylesheet" href="{% static 'css/review_form.css' %}">{% endblock %}

{% block content %}
<div class="reviewFormContainer">
  <!-- Profile Header -->
  <div style="margin-bottom:32px; padding:24px; background:linear-gradient(135deg, rgba(59,130,246,0.1), rgba(139,92,246,0.1)); border-radius:16px; border:1px solid rgba(139,92,246,0.2);">
    <div style="display:flex; align-items:center; gap:20px; margin-bottom:20px;">
      <!-- Avatar -->
      <div style="width:100px; height:100px; border-radius:12px; background:linear-gradient(135deg, #3b82f6, #8b5cf6); display:flex; align-items:center; justify-content:center; color:white; font-size:40px; font-weight:bold;">
        {{ user.username|first|upper }}
      </div>
      
      <!-- Basic Info -->
      <div style="flex:1;">
        <h1 style="margin:0 0 8px; font-size:28px;">{{ user.username }}</h1>
        <p style="color:var(--muted); margin:0 0 8px;">Developer Account</p>
        <p style="color:var(--muted); font-size:13px; margin:0;">Member since {{ user.date_joined|date:"F Y" }}</p>
      </div>
      
      <!-- Developer Badge -->
      <div style="padding:12px 16px; background:rgba(34,197,94,0.15); border:1px solid rgba(34,197,94,0.3); border-radius:12px; color:rgba(34,197,94,0.9);">
        âœ“ Verified Developer
      </div>
    </div>
  </div>

  <!-- Messages -->
  {% if messages %}
    <div style="margin-bottom:16px;">
      {% for message in messages %}
        <div style="padding:12px; border-radius:12px; margin-bottom:8px; background:rgba(34,197,94,0.15); border:1px solid rgba(34,197,94,0.3); color:rgba(34,197,94,0.9);">
          {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}

  <!-- Developer Stats -->
  <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:16px; margin-bottom:32px;">
    <!-- Total Apps -->
    <div style="padding:20px; background:rgba(59,130,246,0.1); border:1px solid rgba(59,130,246,0.2); border-radius:12px;">
      <div style="font-size:24px; font-weight:bold; color:#3b82f6; margin-bottom:4px;">{{ user.apps.count }}</div>
      <div style="color:var(--muted); font-size:13px;">Apps Published</div>
    </div>
    
    <!-- Total Downloads -->
    <div style="padding:20px; background:rgba(139,92,246,0.1); border:1px solid rgba(139,92,246,0.2); border-radius:12px;">
      <div style="font-size:24px; font-weight:bold; color:#8b5cf6; margin-bottom:4px;">{{ total_downloads }}</div>
      <div style="color:var(--muted); font-size:13px;">Total Downloads</div>
    </div>
    
    <!-- Avg Rating -->
    <div style="padding:20px; background:rgba(251,191,36,0.1); border:1px solid rgba(251,191,36,0.2); border-radius:12px;">
      <div style="font-size:24px; font-weight:bold; color:#fbbf24; margin-bottom:4px;">{{ avg_rating|floatformat:1 }}/5</div>
      <div style="color:var(--muted); font-size:13px;">Average Rating</div>
    </div>
    
    <!-- Total Reviews -->
    <div style="padding:20px; background:rgba(236,72,153,0.1); border:1px solid rgba(236,72,153,0.2); border-radius:12px;">
      <div style="font-size:24px; font-weight:bold; color:#ec4899; margin-bottom:4px;">{{ total_reviews }}</div>
      <div style="color:var(--muted); font-size:13px;">Reviews Received</div>
    </div>
  </div>

  <!-- My Apps Section -->
  <div style="margin-bottom:32px;">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
      <h2 style="margin:0;">My Applications</h2>
      <a href="{% url 'apps:upload' %}" class="btn primary" style="padding:8px 16px; font-size:14px;">+ Upload New App</a>
    </div>
    
    {% if user.apps.all %}
      <div style="display:grid; grid-template-columns:repeat(auto-fill, minmax(250px, 1fr)); gap:16px;">
        {% for app in user.apps.all %}
          <div style="padding:16px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px; transition:.12s;">
            <!-- App Header -->
            <div style="margin-bottom:12px;">
              <h3 style="margin:0 0 8px; font-size:16px; font-weight:600;">{{ app.title }}</h3>
              <p style="margin:0; color:var(--muted); font-size:13px;">v{{ app.version }}</p>
            </div>
            
            <!-- Stats -->
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-bottom:12px; padding-bottom:12px; border-bottom:1px solid var(--line);">
              <div>
                <div style="font-size:14px; font-weight:600;">{{ app.downloads }}</div>
                <div style="font-size:12px; color:var(--muted);">Downloads</div>
              </div>
              <div>
                <div style="font-size:14px; font-weight:600;">{{ app.reviews.count }}</div>
                <div style="font-size:12px; color:var(--muted);">Reviews</div>
              </div>
            </div>
            
            <!-- Status -->
            <div style="margin-bottom:12px;">
              {% if app.is_published %}
                <span style="display:inline-block; padding:4px 8px; background:rgba(34,197,94,0.15); border:1px solid rgba(34,197,94,0.3); color:rgba(34,197,94,0.9); border-radius:6px; font-size:12px;">Published</span>
              {% else %}
                <span style="display:inline-block; padding:4px 8px; background:rgba(156,163,175,0.15); border:1px solid rgba(156,163,175,0.3); color:rgba(156,163,175,0.9); border-radius:6px; font-size:12px;">Draft</span>
              {% endif %}
            </div>
            
            <!-- Actions -->
            <div style="display:flex; gap:8px;">
              <a href="{% url 'apps:detail' slug=app.slug %}" class="btn secondary" style="flex:1; padding:8px; font-size:13px; text-align:center;">View</a>
              <a href="{% url 'apps:edit' slug=app.slug %}" class="btn secondary" style="flex:1; padding:8px; font-size:13px; text-align:center;">Edit</a>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div style="padding:32px; text-align:center; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
        <p style="color:var(--muted); margin:0 0 16px;">You haven't uploaded any apps yet.</p>
        <a href="{% url 'apps:upload' %}" class="btn primary">Upload Your First App</a>
      </div>
    {% endif %}
  </div>

  <!-- Account Information Section -->
  <div style="margin-bottom:32px;">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
      <h2 style="margin:0;">Account Information</h2>
      <a href="{% url 'accounts:edit_profile' %}" class="btn primary" style="padding:8px 16px; font-size:14px;">Edit Profile</a>
    </div>
    
    <div style="padding:20px; background:rgba(255,255,255,0.04); border:1px solid var(--line); border-radius:12px;">
      <div style="display:grid; gap:16px;">
        <div style="display:flex; justify-content:space-between; padding:12px 0; border-bottom:1px solid var(--line);">
          <div style="color:var(--muted);">Username</div>
          <div style="font-weight:500;">{{ user.username }}</div>
        </div>
        <div style="display:flex; justify-content:space-between; padding:12px 0; border-bottom:1px solid var(--line);">
          <div style="color:var(--muted);">Email</div>
          <div style="font-weight:500;">{{ user.email }}</div>
        </div>
        <div style="display:flex; justify-content:space-between; padding:12px 0; border-bottom:1px solid var(--line);">
          <div style="color:var(--muted);">Full Name</div>
          <div style="font-weight:500;">{{ user.get_full_name|default:"Not set" }}</div>
        </div>
        <div style="display:flex; justify-content:space-between; padding:12px 0; border-bottom:1px solid var(--line);">
          <div style="color:var(--muted);">Phone</div>
          <div style="font-weight:500;">{{ user.phone|default:"Not set" }}</div>
        </div>
        <div style="display:flex; justify-content:space-between; padding:12px 0; border-bottom:1px solid var(--line);">
          <div style="color:var(--muted);">User ID</div>
          <div style="font-weight:500;">#{{ user.id }}</div>
        </div>
        <div style="display:flex; justify-content:space-between; padding:12px 0; border-bottom:1px solid var(--line);">
          <div style="color:var(--muted);">Joined</div>
          <div style="font-weight:500;">{{ user.date_joined|date:"M d, Y" }}</div>
        </div>
        <div style="display:flex; justify-content:space-between; padding:12px 0;">
          <div style="color:var(--muted);">Last Login</div>
          <div style="font-weight:500;">{{ user.last_login|date:"M d, Y H:i"|default:"Never" }}</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Developer Resources -->
  <div style="margin-bottom:32px; padding:20px; background:linear-gradient(135deg, rgba(59,130,246,0.1), rgba(139,92,246,0.1)); border:1px solid rgba(139,92,246,0.2); border-radius:12px;">
    <h3 style="margin:0 0 16px;">Developer Resources</h3>
    <div style="display:grid; gap:12px;">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <div>
          <div style="font-weight:500; margin-bottom:4px;">Guidelines</div>
          <div style="color:var(--muted); font-size:13px;">App submission and quality guidelines</div>
        </div>
        <a href="/community-guidelines/" class="btn secondary" style="padding:8px 12px; font-size:13px;">Read</a>
      </div>
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <div>
          <div style="font-weight:500; margin-bottom:4px;">Support</div>
          <div style="color:var(--muted); font-size:13px;">Get help with your apps</div>
        </div>
        <a href="/support/" class="btn secondary" style="padding:8px 12px; font-size:13px;">Contact</a>
      </div>
    </div>
  </div>

  <!-- Danger Zone -->
  <div style="margin-top:32px; padding:20px; border:1px solid rgba(251,113,133,0.3); background:rgba(251,113,133,0.05); border-radius:12px;">
    <h3 style="margin:0 0 16px; color:rgba(251,113,133,0.9);">Danger Zone</h3>
    <p style="color:var(--muted); margin:0 0 16px; font-size:13px;">Irreversible and destructive actions</p>
    
    <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:12px;">
      <!-- Change Password -->
      <button type="button" class="btn" style="background:rgba(251,191,36,0.15); border:1px solid rgba(251,191,36,0.3); color:rgba(251,191,36,0.9); display:block; text-align:center; padding:10px; width:100%; cursor:pointer;" onclick="alert('Password change feature coming soon!');">
        Change Password
      </button>
      
      <!-- Logout -->
      <form method="post" action="{% url 'accounts:logout' %}" style="display:inline-block; width:100%;">
        {% csrf_token %}
        <button type="submit" class="btn" style="background:rgba(251,113,133,0.15); border:1px solid rgba(251,113,133,0.3); color:rgba(251,113,133,0.9); width:100%; cursor:pointer;">
          Logout
        </button>
      </form>
    </div>
  </div>
</div>
{% endblock %}
